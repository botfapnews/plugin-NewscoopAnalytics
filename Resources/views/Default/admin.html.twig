{% extends 'NewscoopNewscoopBundle::admin_layout.html.twig' %}

{% block admin_title %}{{ 'plugin.admin.title'|trans }}{% endblock %}
{% block admin_page_title_content %}{{ 'plugin.admin.titlecontent'|trans }} {% endblock %}
{% block admin_stylesheets %}
    <link rel="stylesheet" type="text/css" href="{{ asset('public/bundles/newscooppiwik/piwik.css') }}"/>
{% endblock %}

{% block admin_content %}
<div id="description">
	<p>{{ 'plugin.admin.content'|trans }}</p>
</div>

<div id="tabs" class="col-md-3">
	<h4>{{ 'plugin.admin.menu-left'|trans }} <span class="glyphicon glyphicon-list"></h4>
		<ul class="nav nav-tabs">
		{% for item in publications %}
			<li class="{% if item.id == id %} active {% endif %}"><a href="{{ path('setting_id', {'id': item.id}) }}"> {{ item.name }} {% if item.id == id %}<span class="glyphicon glyphicon-folder-open">{% endif %}</a></li>
		{% endfor %}
		</ul>
</div>
	
<div class="tab-content">
	<div id="forms" class="form col-md-3">
	{% if error %}
		<p class="alert alert-warning">{{ error }}</p>
	{% endif %}

	{% if id %}
		{% if sent %}
		<p class="alert alert-success">{{ sent }}</p>
		{% endif %}

		<div class="row">
			<label id="pubid">{{ 'plugin.admin.pub-id'|trans }} </label>{{ alias.name }} (ID: {{ id }} )
		</div>		
		{{ form_start(form, { 'attr': { 'class': 'form-horizontal' }}) }}

		<div class="row">
			{{ form_label(form.piwikUrl, 'plugin.admin.piwik-url'|trans) }}
			{{ form_widget(form.piwikUrl, { 'attr': { 'placeholder': 'plugin.admin.enter-url'|trans }}) }}
			{{ form_errors(form.piwikUrl) }}
		</div>

		<div class="row">
			{{ form_label(form.piwikId, "Piwik Site ID") }}
			{{ form_widget(form.piwikId, { 'attr': { 'min' : '1', 'placeholder': 'plugin.admin.enter-id'|trans }}) }}
			{{ form_errors(form.piwikId) }}
		</div>

		<div class="row">
			{{ form_label(form.active, 'plugin.admin.activate'|trans) }}
			{{ form_widget(form.active) }}
		</div>

		<div class="bs-callout-info">
		{% if form.vars.value.piwikUrl %}
		<p>{{ 'plugin.admin.piwik-login'|trans }} <a href="http://{{ form.vars.value.piwikUrl }}" target="_blank">{{ form.vars.value.piwikUrl }} <span class="glyphicon glyphicon-log-in"></a></p>
		{% endif %}

		{% if valid == false %}
			<p>{{ 'plugin.admin.visit-pub'|trans }} <a href="http://{{ alias.name }}" target="_blank">{{ alias.name }} <span class="glyphicon glyphicon-new-window"></a></p>
		{% endif %}
		</div>

		<div id="advanced">
			<h4> {{ 'plugin.admin.advanced'|trans }} <span class="glyphicon glyphicon-cog"></h4>
			<div class="row">
			{{ form_label(form.type, 'plugin.admin.code-type' | trans) }}
			{{ form_widget(form.type) }}
			</div>

			<div class="row" id="piwikpublicationsettings_ipAnonymise">
			{{ form_label(form.ipAnonymise, 'plugin.admin.ip-anonym' | trans) }}
			{{ form_widget(form.ipAnonymise) }}&nbsp;{{ 'plugin.admin.mask-ip'|trans }}
			</div>
		
			<div class="row">
			{{ form_label(form.piwikPost) }}
			{{ form_widget(form.piwikPost) }}&nbsp;{{ 'plugin.admin.method-post'|trans }}
			</div>
		</div>

		<div class="row">
		{{ form_label(form.send) }}
		{{ form_widget(form.send, { 'attr': {'class': 'btn btn-primary'}}) }}
		</div>
		{{ form_end(form) }}
	{% endif %}
	</div>

	<div id="infobox" class="col-md-3 bs-callout-info">
		<h4>{{ 'plugin.admin.sidebar_title'|trans }}</h4>
		<ol>
			<li>{{ 'plugin.admin.sidebar_ol_li1'|trans }}</li>
			<li>{{ 'plugin.admin.sidebar_ol_li2'|trans }}</li>
			<li>{{ 'plugin.admin.sidebar_ol_li3'|trans }}</li>
			<li>{{ 'plugin.admin.sidebar_ol_li4'|trans|raw }} </li>
			<li>{{ 'plugin.admin.sidebar_ol_li5'|trans }} <a href="/admin/themes" target="_blank">{{ 'plugin.admin.theme-manager'|trans }} <span class="glyphicon glyphicon-log-in"></a></li>
				<ul>
					<li>{{ 'plugin.admin.sidebar_ol_ul_li1'|trans|raw }}</li>
					<li>{{ 'plugin.admin.sidebar_ol_ul_li2'|trans|raw }}</li>
				</ul>
			<li> {{ 'plugin.admin.done'|trans }}</li>
		</ol>

		<h5>{{ 'plugin.admin.prerequisites'|trans }} <span class="glyphicon glyphicon-flag"></h5>
		<ol>
			<li>{{ 'plugin.admin.prerequisites_ol_li1'|trans }}</li>
			<li>{{ 'plugin.admin.prerequisites_ol_li2'|trans }}</li>
		</ol>
		<p><a href="http://piwik.org/" class="btn btn-info btn-lg btn-block" target="_blank" title="http://piwik.org/">{{ 'plugin.admin.more-piwik'|trans }} <span class="glyphicon glyphicon-new-window"></a></p>

		<div class="panel panel-info">
			<div class="panel-body"><span class="glyphicon glyphicon-tag"> {{ 'plugin.admin.sidebar-tip'|trans }}</div>
			<div class="panel-footer">{{ 'plugin.admin.sidebar-tip-info'|trans }}</div>
		</div>	
	</div>
</div>
{% endblock %}